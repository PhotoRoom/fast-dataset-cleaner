(this["webpackJsonpfast-dataset-cleaner"]=this["webpackJsonpfast-dataset-cleaner"]||[]).push([[0],{103:function(e,t){},138:function(e,t,n){},150:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(66),i=n.n(o),c=(n(75),n(2)),s=n(28),l=n.n(s),u=n(67),d=n.n(u),f=function(e){return{isNightMode:e,unit:8,color:{PHOTOROOM:"#00155A",PHOTOROOM_LIGHT:"#2457ff",page:e?"#333":"#fff",reversePage:e?"#fff":"#333",pageNight:"#333",pageDay:"#fff",VALID:"#3caf40",NOTVALID:"#e45247",banner:"#000e3e",bannerText:"#fff",bannerSeparator:"#ddd",overlay:"#000"},speed:{fast:.3,veryFast:.15,ultraFast:0},fontSize:{small:10,medium:14,large:16,xlarge:20},fontFamily:"Ubuntu",opacity:{light:.2,medium:.5,dark:.8}}},g=(n(138),n(1)),m=n(14),h=n(15),p=["ArrowLeft"],v=["ArrowRight"],b=["Enter"],E=[" ","m"],O=["g","i"],w=function(e){return Object(a.useEffect)((function(){return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[e])},S=function(e,t,n,a){var r=e.key;p.includes(r)?t():v.includes(r)?n():b.includes(r)&&a()},y=function(e){return localStorage.getItem(e)},x=function(e,t){return localStorage.setItem(e,t.trim())},k=function(){return y("annotator")},j=["2","4","6","8"],C=function(){return parseInt(y("imagesPerPage")||"8")},I=function(e){return x("imagesPerPage",e)},A=function(){return y("sha_pass")},P=function(e){return x("sha_pass",e)},_=function(){return y("datasetPath")},N=function(e){return x("datasetPath",e)},M=function(){return y("imagesFolder")},H=function(e){return x("imagesFolder",e)},F=function(){return y("masksFolder")},L=function(e){return x("masksFolder",e)},D=["true","false"],R=function(){return y("useMasks")},T=function(e){return x("useMasks",e)},B=function(){return y("idColumnName")},V=function(e){return x("idColumnName",e)},z=function(){return y("imagesExtension")},U=function(e){return x("imagesExtension",e)},G=function(){return y("masksExtension")},W=function(e){return x("masksExtension",e)},X=function(){return"true"===y("annotationUltraFast")},K=n(68),J=n.n(K);var Y=Object(g.withStyles)((function(e){var t=e.unit,n=e.fontSize;return{displayedText:{color:e.color.bannerText,textAlign:"left",fontSize:n.medium,marginBlockEnd:1.5*t,textOverflow:"ellipsis",overflow:"hidden","line-break":"anywhere"}}}))((function(e){var t=e.text,n=e.css,a=e.styles;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement("h3",n(a.displayedText),t))}));var $=Object(g.withStyles)((function(e){var t=e.unit,n=e.fontSize,a=e.fontFamily,r=e.color,o=e.speed;return{titleInput:{color:r.bannerText,textAlign:"left",fontSize:n.large,marginBlockEnd:1.5*t,textOverflow:"ellipsis",overflow:"hidden",maxHeight:n.large+.25*t},inputArea:{width:"calc(100% - ".concat(4*t,"px)"),fontSize:n.large,padding:"".concat(.5*t,"px ").concat(1.5*t,"px"),borderRadius:1.5*t,background:r.page,color:r.reversePage,fontFamily:a,transition:"background ".concat(o.fast,"s ease-in-out,\n                    color ").concat(o.fast,"s ease-in-out,\n                    box-shadow ").concat(o.fast,"s ease-in-out"),":focus":{boxShadow:"0 0 ".concat(t,"px 0 ").concat(r.bannerText)}},bannerElement:{margin:"".concat(t,"px 0"),transition:"transform ".concat(o.fast," ease-in-out, opacity ").concat(o.fast," ease-in-out")},bannerHidden:{transform:"scale(0.9)",opacity:0}}}))((function(e){var t=e.title,n=e.isHidden,o=e.value,i=e.displayInputValue,s=e.onChange,l=e.onBlur,u=e.css,d=e.styles,f=Object(a.useState)(null===o?"":o),g=Object(c.a)(f,2),m=g[0],h=g[1];return r.a.createElement("div",u(d.bannerElement,n&&d.bannerHidden),r.a.createElement("label",null,t&&r.a.createElement("h3",u(d.titleInput),t),i&&r.a.createElement(Y,{text:m}),r.a.createElement("input",Object.assign({type:"text",value:o||"",onChange:function(e){var t=e.target.value;h(t),s&&s(e)},onBlur:l},u(d.inputArea)))))})),q=Object(g.withStyles)((function(e){var t=e.unit,n=e.color;return{separator:{width:"100%",margin:"".concat(3*t,"px 0"),borderRadius:3*t,height:.25*t,background:n.bannerSeparator},thinSeparator:{height:.125*t,margin:"".concat(2.5*t,"px 0 ").concat(2*t,"px 0")}}}))((function(e){var t=e.thin,n=e.css,a=e.styles;return r.a.createElement("div",n(a.separator,t&&a.thinSeparator))}));var Q,Z=Object(g.withStyles)((function(e){var t=e.unit,n=e.fontSize,a=e.fontFamily,r=e.color,o=e.speed;return{titleInput:{color:r.bannerText,textAlign:"left",fontSize:n.large,marginBlockEnd:1.5*t,textOverflow:"ellipsis",overflow:"hidden",maxHeight:n.large+.25*t},select:{width:"100%",fontSize:n.large,height:n.large+2*t,padding:"".concat(.5*t,"px ").concat(1.5*t,"px"),borderRadius:1.5*t,background:r.page,color:r.reversePage,fontFamily:a,transition:"background ".concat(o.fast,"s ease-in-out,\n                    color ").concat(o.fast,"s ease-in-out,\n                    box-shadow ").concat(o.fast,"s ease-in-out"),":focus":{boxShadow:"0 0 ".concat(t,"px 0 ").concat(r.bannerText)}},bannerElement:{margin:"".concat(t,"px 0"),transition:"transform ".concat(o.fast," ease-in-out, opacity ").concat(o.fast," ease-in-out")},bannerHidden:{transform:"scale(0.9)",opacity:0}}}))((function(e){var t=e.title,n=e.name,a=e.isHidden,o=e.value,i=e.options,c=e.onChange,s=e.css,l=e.styles;return r.a.createElement("div",s(l.bannerElement,a&&l.bannerHidden),r.a.createElement("label",null,r.a.createElement("h3",s(l.titleInput),t),r.a.createElement("select",Object.assign({name:n,value:o||"",onChange:c},s(l.select)),i.map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))))}));!function(e){e.PASSWORD="sha",e.IMAGES_PER_PAGE="imgPerPage",e.CSV_PATH="csv",e.IMAGES_FOLDER="imagesFolder",e.MASKS_FOLDER="masksFolder",e.USE_MASKS="useMasks",e.ID_COLUMN="idColumn",e.IMAGES_EXTENSION="imgExt",e.MASKS_EXTENSION="maskExt"}(Q||(Q={}));var ee=function(){var e=new URL(window.location.href).origin,t=function(){var e=[],t=A(),n=_(),a=C(),r=M(),o=F(),i=R(),c=B(),s=z(),l=G();return n&&e.push("".concat(Q.CSV_PATH,"=").concat(n)),a&&e.push("".concat(Q.IMAGES_PER_PAGE,"=").concat(a)),c&&e.push("".concat(Q.ID_COLUMN,"=").concat(c)),r&&e.push("".concat(Q.IMAGES_FOLDER,"=").concat(r)),i&&e.push("".concat(Q.USE_MASKS,"=").concat(i)),"true"===(null===i||void 0===i?void 0:i.toLowerCase())&&o&&e.push("".concat(Q.MASKS_FOLDER,"=").concat(o)),s&&e.push("".concat(Q.IMAGES_EXTENSION,"=").concat(s)),l&&e.push("".concat(Q.MASKS_EXTENSION,"=").concat(l)),t&&e.push("".concat(Q.PASSWORD,"=").concat(t)),e===[]?"":"?"+e.join("&")}();return"".concat(e).concat(t)};function te(){window.history.pushState(null,"Fast Dataset Cleaner",ee())}var ne=function(e,t,n){var a=e.searchParams.get(t);a&&n(a)};var ae=Object(g.withStyles)((function(e){var t=e.unit,n=e.fontSize,a=e.fontFamily,r=e.color,o=e.speed,i=e.isNightMode;return{button:{width:"100%",fontFamily:a,fontSize:n.large,fontWeight:"bold",padding:"".concat(t,"px ").concat(1.5*t,"px"),borderRadius:2*t,background:i?r.pageNight:r.pageDay,color:i?r.pageDay:r.pageNight,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",maxHeight:n.large+.25*t+3*t,cursor:"pointer",transition:"background ".concat(o.fast,"s ease-in-out, color ").concat(o.fast,"s ease-in-out")},bannerElement:{transition:"transform ".concat(o.fast," ease-in-out, opacity ").concat(o.fast," ease-in-out")},bannerHidden:{transform:"scale(0.9)",opacity:0}}}))((function(e){var t=e.title,n=e.isHidden,a=e.handleClick,o=e.css,i=e.styles;return r.a.createElement("div",o(i.bannerElement,n&&i.bannerHidden),r.a.createElement("button",Object.assign({type:"button"},o(i.button),{onClick:a}),t))}));var re=Object(g.withStyles)((function(e){var t=e.unit,n=e.fontSize,a=e.color,r=e.speed;return{titleSection:{color:a.bannerText,textAlign:"center",fontSize:n.xlarge,marginBlockEnd:1.5*t,marginBlockStart:.5*t,textOverflow:"ellipsis",overflow:"hidden"},bannerElement:{margin:"0 0 ".concat(t,"px 0"),transition:"transform ".concat(r.fast," ease-in-out, opacity ").concat(r.fast," ease-in-out")},bannerHidden:{transform:"scale(0.9)",opacity:0}}}))((function(e){var t=e.title,n=e.isHidden,a=e.children,o=e.css,i=e.styles;return r.a.createElement("div",o(i.bannerElement,n&&i.bannerHidden),t&&r.a.createElement("h2",o(i.titleSection),t),a,r.a.createElement(q,{thin:!0}))})),oe=Object(g.withStyles)((function(e){var t=e.fontSize,n=e.color,a=e.speed;return{switch:{position:"relative",display:"inline-block",width:56,height:32,backgroundColor:n.bannerSeparator,borderRadius:32,margin:"".concat(4,"px ").concat(12,"px"),transition:"background-color ".concat(a.fast,"s ease-in-out")},switchChecked:{backgroundColor:n.PHOTOROOM_LIGHT},switchInput:{opacity:0,width:0,height:0},roundSlider:{position:"absolute",top:4,right:0,transition:"transform ".concat(a.fast,"s ease-in-out"),borderRadius:32,content:"",height:24,width:24,left:4,bottom:4,backgroundColor:"white"},roundSliderChecked:{transform:"translateX(".concat(24,"px)")},switchArea:{cursor:"pointer"},switchLegend:{position:"relative",display:"inline-block",fontSize:t.medium,top:6,margin:0,color:n.pageDay},bannerHidden:{transform:"scale(0.9)",opacity:0}}}))((function(e){var t=e.value,n=e.stateFalse,o=e.stateTrue,i=e.isHidden,s=e.handleClick,l=e.css,u=e.styles,d=Object(a.useState)(t),f=Object(c.a)(d,2),g=f[0],m=f[1];return r.a.createElement("label",l(u.switchArea,i&&u.bannerHidden),r.a.createElement("h4",l(u.switchLegend),n),r.a.createElement("div",l(u.switch,g&&u.switchChecked),r.a.createElement("input",Object.assign({type:"checkbox",onClick:function(){var e=!g;m(e),s(e)}},l(u.switchInput))),r.a.createElement("span",l(u.roundSlider,g&&u.roundSliderChecked))),r.a.createElement("h4",l(u.switchLegend),o))})),ie=function(){return window.location.reload(!1)};var ce=Object(g.withStyles)((function(e){var t=e.unit,n=e.speed;return{bannerContent:{width:0,margin:24,marginTop:19*t,zIndex:2,overflowY:"auto",maxHeight:"85vh",transition:"width ".concat(n.fast,"s ease-in-out")},bannerOpen:{width:"calc(100% - 2 * ".concat(24,"px)")}}}))((function(e){var t=e.isClicked,n=e.css,o=e.styles,i=Object(a.useState)(k()||""),s=Object(c.a)(i,2),l=s[0],u=s[1],d=Object(a.useState)(_()||""),f=Object(c.a)(d,2),g=f[0],m=f[1],h=Object(a.useState)(C()||8),p=Object(c.a)(h,2),v=p[0],b=p[1],E=Object(a.useState)(A()||""),O=Object(c.a)(E,2),w=O[0],S=O[1],y=Object(a.useState)(M()||""),K=Object(c.a)(y,2),J=K[0],Q=K[1],ee=Object(a.useState)(F()||""),ne=Object(c.a)(ee,2),ce=ne[0],se=ne[1],le=Object(a.useState)(R()||"false"),ue=Object(c.a)(le,2),de=ue[0],fe=ue[1],ge=Object(a.useState)(B()||"id"),me=Object(c.a)(ge,2),he=me[0],pe=me[1],ve=Object(a.useState)(z()||""),be=Object(c.a)(ve,2),Ee=be[0],Oe=be[1],we=Object(a.useState)(G()||""),Se=Object(c.a)(we,2),ye=Se[0],xe=Se[1],ke=Object(a.useState)(X()||!1),je=Object(c.a)(ke,2),Ce=je[0],Ie=je[1];Object(a.useEffect)((function(){B()||V("id")}),[]);var Ae=Object(a.useCallback)((function(e){return r.a.createElement($,Object.assign({isHidden:!t},e))}),[t]),Pe=Object(a.useCallback)((function(e){return r.a.createElement(Z,Object.assign({isHidden:!t},e))}),[t]),_e=Object(a.useCallback)((function(e){return r.a.createElement(oe,Object.assign({isHidden:!t},e))}),[t]),Ne=Object(a.useCallback)((function(e){return r.a.createElement(re,Object.assign({isHidden:!t},e))}),[t]),Me=Object(a.useCallback)((function(e){return r.a.createElement(ae,Object.assign({isHidden:!t},e))}),[t]);return r.a.createElement("div",n(o.bannerContent,t&&o.bannerOpen),t&&r.a.createElement(q,null),r.a.createElement(Ne,{title:"Password"},r.a.createElement(Ae,{value:w,onChange:function(e){var t=e.target.value;S(t),P(t),te()}})),r.a.createElement(Ne,{title:"About the CSV"},r.a.createElement(Ae,{displayInputValue:!0,title:"CSV path",value:g,onChange:function(e){var t=e.target.value;N(t),m(t),te()}}),r.a.createElement(Ae,{title:"Name of the id column",value:he,onChange:function(e){var t=e.target.value;pe(t),V(t),te()}})),r.a.createElement(Ne,{title:"Images"},r.a.createElement(Y,{text:"".concat(J||"/path/to/folder/","{id}").concat(Ee)}),r.a.createElement(Ae,{title:"Images folder",value:J,onChange:function(e){var t=e.target.value;H(t),Q(t),te()}}),r.a.createElement(Ae,{title:"Images extension",value:Ee,onChange:function(e){var t=e.target.value;Oe(t),U(t),te()}})),r.a.createElement(Ne,{title:"Masks"},r.a.createElement(Pe,{title:"Use masks",name:"use_masks",value:de,options:D,onChange:function(e){var t=e.target.value;fe(t),T(t),te()}}),"true"===de&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Y,{text:"".concat(ce||"/path/to/folder/","{id}").concat(ye)}),r.a.createElement(Ae,{title:"Masks folder",value:ce,onChange:function(e){var t=e.target.value;L(t),se(t),te()}}),r.a.createElement(Ae,{title:"Masks extension",value:ye,onChange:function(e){var t=e.target.value;xe(t),W(t),te()}}))),r.a.createElement(Ne,{title:"Annotation"},r.a.createElement(Ae,{title:"Annotator",value:l,onChange:function(e){var t=e.target.value;!function(e){x("annotator",e)}(t),u(t)}}),r.a.createElement(Pe,{title:"Images per page",name:"img_per_page",value:v.toString(),options:j,onChange:function(e){var t=e.target.value;I(t),b(t),te()}}),r.a.createElement(_e,{value:Ce,stateFalse:"Fast mode",stateTrue:"Ludicrous mode",handleClick:function(e){Ie(e),function(e){x("annotationUltraFast","".concat(e))}(e)}})),r.a.createElement(Me,{title:"Get images",handleClick:ie}))}));var se=Object(g.withStyles)((function(e){var t=e.opacity,n=e.color,a=e.speed;return{overlay:{width:"100vw",height:"100vh",position:"fixed",top:0,left:0,background:n.overlay,opacity:t.dark,transition:"opacity ".concat(a.fast,"s ease-in-out"),":hover":{cursor:"pointer"}},overlayHidden:{opacity:0}}}))((function(e){var t=e.zIndex,n=e.isVisible,a=e.handleClick,o=e.css,i=e.styles;return r.a.createElement("div",Object.assign({onClick:a,style:{zIndex:t||1}},o(n?i.overlay:i.overlayHidden)))})),le=function(){},ue=["input","select","button","textarea"];var de=Object(g.withStyles)((function(e){var t=e.unit,n=e.color,a=e.speed;return{banner:{width:88,height:"100vh",background:n.banner,boxShadow:"0px 0px 20px 0px #000",position:"fixed",top:0,left:0,zIndex:2,cursor:"pointer",transition:"width ".concat(a.fast,"s ease-in-out")},bannerOpen:{width:336,cursor:"default"},logoClicked:{transform:"rotate(720deg)",height:96,left:3*t,top:3*t},logoNotClicked:{transform:"rotate(0deg)"},logo:{position:"fixed",top:2*t,left:t,height:64,border:"2px solid #fff",borderRadius:3.5*t,cursor:"pointer",transition:"transform ".concat(a.fast,"s ease-in-out, height ").concat(a.fast,"s ease-in-out, left ").concat(a.fast,"s ease-in-out, top ").concat(a.fast,"s ease-in-out")},nightButton:{position:"fixed",left:6*t+96,top:96-t,width:"calc(".concat(240-6*t-5*t,"px)"),padding:"0 ".concat(t,"px"),opacity:1,transition:"opacity ".concat(.5*a.fast,"s ease-in-out, width ").concat(a.fast-.05,"s ease-in-out 0.05s, left ").concat(a.fast,"s ease-in-out")},nightButtonHidden:{left:4*t+64,width:"calc(".concat(24-4*t-5*t,"px * 0.75)"),opacity:0}}}))((function(e){var t=e.isBannerOpen,n=e.handleBanner,o=e.nightMode,i=e.changeNightMode,c=e.css,s=e.styles;Object(a.useEffect)((function(){var e=function(e){var a=e.key,r=document.activeElement&&-1===ue.indexOf(document.activeElement.tagName.toLowerCase());r&&E.includes(a)?n(!t):r&&t&&O.includes(a)&&ie()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[t,n]);var l=function(){n(!t)},u=o?"Night mode":"Day mode";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",Object.assign({onClick:t?le:l},c(s.banner,t&&s.bannerOpen)),r.a.createElement("img",Object.assign({src:J.a,alt:"Logo",onClick:l},c(s.logo,t?s.logoClicked:s.logoNotClicked))),r.a.createElement("div",c(s.nightButton,!t&&s.nightButtonHidden),r.a.createElement(ae,{title:u,isHidden:!t,handleClick:i})),r.a.createElement(ce,{isClicked:t})),r.a.createElement(se,{isVisible:t,handleClick:function(){n(!1)}}))}));var fe="calc(100vh / ".concat(C()/2," - ").concat(16,"px)"),ge=Object(g.withStyles)((function(e){var t=e.unit,n=e.color,a=e.speed,r=e.fontSize;return{card:{maxHeight:"calc(100vh / ".concat(C()/2,")"),border:"1px solid #ccc",borderRadius:3*t,margin:"".concat(.5*t,"px ").concat(1*t,"px"),height:"calc(100% - 2 * ".concat(.75*t,"px)"),minHeight:"calc((100vh - ".concat(4*t+2*t,"px) / ").concat(C()/2," - ").concat(1*t,"px)"),transition:"background ".concat(a.fast,"s ease,\n            box-shadow ").concat(a.fast,"s ease,\n            transform ").concat(a.fast,"s ease,\n            opacity ").concat(a.fast,"s ease"),overflow:"hidden",cursor:"pointer",":hover":{boxShadow:"0 0 ".concat(2.5*t,"px 0 #000")}},cardUltraFast:{transition:"background ".concat(a.ultraFast,"s ease,\n            box-shadow ").concat(a.ultraFast,"s ease,\n            transform ").concat(a.ultraFast,"s ease,\n            opacity ").concat(a.ultraFast,"s ease")},cardValid:{background:n.VALID},cardNotValid:{background:n.NOTVALID},cardNotValidUltraFast:{opacity:.05},annotated:{marginTop:t,fontSize:r.large},cardAnnotated:{opacity:.5},idCard:{fontWeight:"bold",position:"absolute",width:5*t,borderRight:"1px solid #ccc",height:"100%",maxHeight:fe},id:{marginTop:1.5*t},image:{height:"100%",marginLeft:5*t,maxHeight:fe,maxWidth:"calc(100% - ".concat(5*t+2*t,"px)")}}}))((function(e){var t=e.isBannerOpen,n=e.sample,o=e.navigationDirection,i=e.fetchService,s=e.handleChangeValue,l=e.css,u=e.styles,d=n.id,f=n.value,g=n.sampleNumber,p=n.annotated,v=n.changing,b=n.name,E=Object(a.useState)(f),O=Object(c.a)(E,2),S=O[0],y=O[1],x=X();Object(a.useEffect)((function(){return y(f)}),[f]);var k=Object(a.useState)(!1),j=Object(c.a)(k,2),C=j[0],I=j[1];Object(a.useEffect)((function(){return I(!0),function(){return I(!1)}}),[]);var A=Object(a.useCallback)((function(){s(!S,g),y(!S)}),[S,g,s]),P=Object(a.useCallback)((function(e){var n=e.key;parseInt(n)!==d||t||A()}),[d,t,A]);w(P);var _={maxWidth:"45vw",width:"calc((100vw - ".concat(88,"px) / 2 - ").concat(80,"px)"),display:"inline-block"},N="translateX(".concat("left"===o?"-":"","100vw)"),M={from:Object(m.a)({opacity:0,transform:N},_),enter:Object(m.a)({opacity:1,transform:"translateX(0)"},_),leave:Object(m.a)({opacity:0,transform:N},_)},H=Object(h.b)(C,null,M);return r.a.createElement(r.a.Fragment,null,H.map((function(e){var t=e.item,n=e.key,a=e.props;return t&&r.a.createElement(h.a.div,{key:n,style:a},r.a.createElement("div",Object.assign({onClick:A,onKeyDown:P},l(u.card,x&&u.cardUltraFast,S?u.cardValid:u.cardNotValid,p&&!v&&u.cardAnnotated,x&&!S&&u.cardNotValidUltraFast)),r.a.createElement("div",l(u.idCard),r.a.createElement("div",l(u.id),d),p&&r.a.createElement("div",l(u.annotated),S?"\u2714":"\u2718")),r.a.createElement("img",Object.assign({src:i.getImage(b),alt:"source"},l(u.image)))))})))}));var me,he="calc(100vh - 2 * ".concat(8,"px)"),pe=Object(g.withStyles)((function(e){var t=e.color,n=e.unit,a=e.speed;return{mainColumn:{background:t.page,marginLeft:88+2*n,marginRight:0,paddingTop:n,paddingBottom:n,display:"flex",flexWrap:"wrap",height:he,transition:"background ".concat(a.fast,"s ease-in-out")}}}))((function(e){var t=e.isBannerOpen,n=e.images,a=e.fetchService,o=e.navigationDirection,i=e.handleChangeValue,c=e.css,s=e.styles;return r.a.createElement("div",c(s.mainColumn),n.map((function(e){return r.a.createElement(ge,{sample:e,isBannerOpen:t,handleChangeValue:i,navigationDirection:o,fetchService:a,key:e.name})})))})),ve=n(8),be=n.n(ve),Ee=n(19),Oe=n(4),we=n(7),Se="get-annotations",ye="get-image",xe="annotate",ke={accept:"application/json","content-type":"application/json","Access-Control-Allow-Origin":"*"},je=function(e){return{method:"POST",headers:ke,body:JSON.stringify(Object(m.a)({sha:A()},e))}};!function(e){e.ID="id",e.PASSWORD="sha"}(me||(me={}));var Ce=function(e){return e.map((function(e){return function(e){return{id:e.index%C()+1,sampleNumber:e.index,value:"string"==typeof e.value||e.value,name:e.id,annotated:"None"!==e.value,changing:!1}}(e)}))},Ie=function(){function e(t){var n=this;Object(Oe.a)(this,e),this.api_address=void 0,this.page=void 0,this.images=void 0,this.totalImages=void 0,this.processedImages=void 0,this.samples=void 0,this.firstLoading=!0,this.getSample=function(){return n.samples||[]},this.getProgress=function(){return{currentPage:n.page,numberImagesPerPage:C(),totalImages:n.totalImages}},this.changePage=function(e,t){return e?(n.page=t,n.getAnnotations()):new Promise((function(){}))},this.incrPage=function(){var e=n.page*C()<=n.totalImages;return n.changePage(e,n.page+1)},this.decrPage=function(){var e=n.page>0;return n.changePage(e,n.page-1)},this.nextPage=function(){n.annotate();var e=n.page*C()<=n.totalImages;return n.changePage(e,n.page+1)},this.setValue=function(e,t){n.samples=n.samples&&n.samples.map((function(n){if(n.sampleNumber===t){var a=n;return n.value=e,n.changing=!n.changing,a}return n}))},this.get=function(){var e=Object(Ee.a)(be.a.mark((function e(t){return be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(n.api_address).concat(t)).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.post=function(){var e=Object(Ee.a)(be.a.mark((function e(t,a){return be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(n.api_address).concat(t),je(a)).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.getAnnotations=Object(Ee.a)(be.a.mark((function e(){var t,a;return be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.firstLoading?-1:n.page*C(),a={first:t,offset:C(),sha:A(),csv_path:_(),images_folder:M(),masks_folder:F(),with_masks:"true"===R(),id_column_name:B(),image_ext:z(),mask_ext:G()},e.abrupt("return",n.post("".concat(Se),a).then((function(e){e.error?alert(e.error):(n.firstLoading&&(n.firstLoading=!1),n.treatNewData(e))})));case 3:case"end":return e.stop()}}),e)}))),this.getImage=function(e){return"".concat(n.api_address).concat(ye,"?").concat(me.ID,"=").concat(e,"&").concat(me.PASSWORD,"=").concat(A())},this.annotate=Object(Ee.a)(be.a.mark((function e(){var t,a,r;return be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={},null===(t=n.samples)||void 0===t||t.map((function(e){return a[e.name]=e.value})),r={annotator:k(),annotations:a,sha:A()},n.post(xe,r).then((function(e){}));case 4:case"end":return e.stop()}}),e)}))),this.api_address=t.api_address,this.page=t.page||0,this.images=t.images||[],this.totalImages=t.totalImages||0,this.processedImages=t.processedImages||0,this.samples=t.images&&Ce(t.images)||[]}return Object(we.a)(e,[{key:"treatNewData",value:function(e){var t=e.images,n=e.total,a=e.processed;if(t&&n&&void 0!==a){if(this.images=t,this.totalImages=n,this.processedImages=a,a<n)this.page=0!==t.length?t[0].index/C():this.page;else{var r=Math.ceil((n-1)/C());this.page=0!==t.length?this.page:r}this.samples=Ce(t)}}}]),e}(),Ae=n(69),Pe=function(e,t,n){var a=e.deltaX,r=e.deltaY;!(1!==window.visualViewport.scale)&&Math.abs(a)>10&&Math.abs(r)<=5&&(a>0?n():t())},_e=function(){return window.location.reload(!1)},Ne=function(e){var t=e.css,n=e.styles;return r.a.createElement("div",t(n.card),r.a.createElement("p",t(n.paragraph),"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2554\u2557\u2500\u2500\u2500\u2554\u2557\u2500\u2500\u2500\u2554\u2557\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2554\u2557\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2554\u255d\u255a\u2557\u2500\u2500\u2551\u2551\u2500\u2500\u2554\u255d\u255a\u2557\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2551\u2551\n\u2554\u2550\u2550\u2566\u2550\u2550\u2566\u2550\u2557\u2554\u2550\u2550\u2566\u2550\u2566\u2550\u2569\u2557\u2554\u256c\u2557\u2554\u2563\u2551\u2554\u2550\u2569\u2557\u2554\u256c\u2566\u2550\u2550\u2566\u2550\u2557\u2554\u2550\u2550\u2563\u2551\n\u2551\u2554\u2550\u2563\u2554\u2557\u2551\u2554\u2557\u2563\u2554\u2557\u2551\u2554\u2563\u2554\u2557\u2551\u2551\u2551\u2551\u2551\u2551\u2551\u2551\u2554\u2557\u2551\u2551\u2560\u2563\u2554\u2557\u2551\u2554\u2557\u2563\u2550\u2550\u256c\u255d\n\u2551\u255a\u2550\u2563\u255a\u255d\u2551\u2551\u2551\u2551\u255a\u255d\u2551\u2551\u2551\u2554\u2557\u2551\u255a\u2563\u255a\u255d\u2551\u255a\u2563\u2554\u2557\u2551\u255a\u2563\u2551\u255a\u255d\u2551\u2551\u2551\u2560\u2550\u2550\u2560\u2557\n\u255a\u2550\u2550\u2569\u2550\u2550\u2569\u255d\u255a\u2569\u2550\u2557\u2560\u255d\u255a\u255d\u255a\u2569\u2550\u2569\u2550\u2550\u2569\u2550\u2569\u255d\u255a\u2569\u2550\u2569\u2569\u2550\u2550\u2569\u255d\u255a\u2569\u2550\u2550\u2569\u255d\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2554\u2550\u255d\u2551\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u255a\u2550\u2550\u255d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500"),r.a.createElement("p",null,"\ud83c\udf8a\ud83c\udf89\ud83d\udc4f Congratulations! \ud83d\udc4f\ud83c\udf89\ud83c\udf8a \n\nYou reached the end of your dataset!\n\nRefresh the page to be sure that you annotated all the images.\n\n If after a refresh you get here, you're good to go on ! \ud83c\udfcb\ud83d\udcbb"),r.a.createElement("div",t(n.reloadButton),r.a.createElement(ae,{title:"Reload the page",isHidden:!1,handleClick:_e})))};var Me=Object(g.withStyles)((function(e){var t=e.unit,n=e.color,a=e.fontSize;return{card:{display:"block",position:"fixed",top:0,left:0,color:n.reversePage,fontSize:a.xlarge,whiteSpace:"pre-line",margin:"auto",marginTop:"20vh",width:"100vw"},paragraph:{margin:"".concat(4*t,"px 0")},reloadButton:{width:"20%",margin:"auto"}}}))((function(e){var t=e.navigationDirection,n=Object(a.useState)(!1),o=Object(c.a)(n,2),i=o[0],s=o[1];Object(a.useEffect)((function(){return s(!0),function(){return s(!1)}}),[]);var l="translateX(".concat("left"===t?"-":"","100vw)"),u={from:{opacity:0,transform:l},enter:{opacity:1,transform:"translateX(0)"},leave:{opacity:0,transform:l}},d=Object(h.b)(i,null,u);return r.a.createElement(r.a.Fragment,null,d.map((function(t){var n=t.item,a=t.key,o=t.props;return n&&r.a.createElement(h.a.div,{key:a,style:o},r.a.createElement(Ne,e))})))}));var He=Object(g.withStyles)((function(e){var t=e.unit,n=e.fontSize,a=e.color,r=e.speed,o=e.isNightMode;return{title:{marginBlockStart:t,marginBlockEnd:t,textAlign:"right"},progress:{position:"absolute",right:0,top:0,fontSize:n.medium,paddingRight:2*t,fontWeight:"bold",borderRadius:2*t,background:o?a.pageNight:a.pageDay,color:o?a.pageDay:a.pageNight,transition:"background ".concat(r.fast,"s ease-in-out, color ").concat(r.fast,"s ease-in-out")},bannerElement:{transition:"transform ".concat(r.fast," ease-in-out, opacity ").concat(r.fast," ease-in-out")},bannerHidden:{transform:"scale(0.9)",opacity:0},arrow:{display:"inline-block",margin:"".concat(2*t,"px ").concat(.25*t,"px"),cursor:"pointer"},navigationArrows:{position:"absolute",display:"inline-block",top:4.5*t}}}))((function(e){var t=e.progress,n=e.handlePressLeft,a=e.handlePressRight,o=e.css,i=e.styles,c=t.currentPage,s=t.numberImagesPerPage,l=t.totalImages,u=l>0?c*s+1:0,d=Math.min((c+1)*s,l),f=(c*s*100/l).toPrecision(4);return r.a.createElement("div",o(i.progress),r.a.createElement("h3",o(i.title),u,"-",d," / ",l),r.a.createElement("h3",o(i.title),"(",f,"%)"),r.a.createElement("h3",o(i.navigationArrows),c>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",Object.assign({onClick:n},o(i.arrow)),"\u2b05"),r.a.createElement("div",o(i.arrow),"|")),r.a.createElement("div",Object.assign({onClick:a},o(i.arrow)),"\u2b95")))})),Fe=new Ie({api_address:"".concat(window.location.origin,"/api/")}),Le=function(){};var De=function(e){var t=e.nightMode,n=e.changeNightMode,o=Object(a.useState)(!k()||!_()||!B()||!A()),i=Object(c.a)(o,2),s=i[0],l=i[1],u=Object(a.useState)([]),d=Object(c.a)(u,2),f=d[0],g=d[1],m=Object(a.useState)("none"),h=Object(c.a)(m,2),p=h[0],v=h[1],b=function(e){v(e),g(Fe.getSample())};Object(a.useEffect)((function(){!function(){var e=new URL(window.location.href);ne(e,Q.PASSWORD,P),ne(e,Q.CSV_PATH,N),ne(e,Q.IMAGES_PER_PAGE,I),ne(e,Q.IMAGES_FOLDER,H),ne(e,Q.MASKS_FOLDER,L),ne(e,Q.USE_MASKS,T),ne(e,Q.ID_COLUMN,V),ne(e,Q.IMAGES_EXTENSION,U),ne(e,Q.MASKS_EXTENSION,W)}(),Fe.getAnnotations().finally((function(){return b("none")}))}),[]);var E,O=function(){return Fe.decrPage().then((function(){return b("left")}))},y=function(){return Fe.incrPage().then((function(){return b("right")}))},x=function(){return Fe.nextPage().then((function(){return b("right")}))};return w((function(e){return s?Le:S(e,O,y,x)})),E=function(e){return s?Le:Pe(e,O,y)},Object(a.useEffect)((function(){var e=Object(Ae.throttle)(E,320);return window.addEventListener("wheel",e),function(){return window.removeEventListener("wheel",e)}}),[E]),r.a.createElement("div",{className:"App"},r.a.createElement(de,{handleBanner:l,isBannerOpen:s,nightMode:t,changeNightMode:n}),0!==f.length?r.a.createElement(pe,{images:f,isBannerOpen:s,handleChangeValue:function(e,t){return Fe.setValue(e,t)},navigationDirection:p,fetchService:Fe}):r.a.createElement(Me,{navigationDirection:p}),0!==f.length&&r.a.createElement(He,{progress:Fe.getProgress(),handlePressLeft:O,handlePressRight:y}))},Re=(new Date).getHours(),Te=Re<=8||Re>=20;var Be=function(){var e=Object(a.useState)(Te),t=Object(c.a)(e,2),n=t[0],o=t[1];return document.body.style=function(e){return"transition: background ".concat(f(e).speed.fast,"s ease; background: ").concat(f(e).color.page)}(n),r.a.createElement(l.a.Provider,{value:{stylesInterface:d.a,stylesTheme:f(n)}},r.a.createElement(De,{nightMode:n,changeNightMode:function(){return o(!n)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},68:function(e,t,n){e.exports=n.p+"static/media/photoroom_logo.fcbc0765.png"},70:function(e,t,n){e.exports=n(150)},75:function(e,t,n){}},[[70,1,2]]]);
//# sourceMappingURL=main.9d6651a5.chunk.js.map